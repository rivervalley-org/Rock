{"version":3,"file":"dialog.js","sources":["../../../Framework/Controls/dialog.ts"],"sourcesContent":["﻿// <copyright>\r\n// Copyright by the Spark Development Network\r\n//\r\n// Licensed under the Rock Community License (the \"License\");\r\n// you may not use this file except in compliance with the License.\r\n// You may obtain a copy of the License at\r\n//\r\n// http://www.rockrms.com/license\r\n//\r\n// Unless required by applicable law or agreed to in writing, software\r\n// distributed under the License is distributed on an \"AS IS\" BASIS,\r\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n// See the License for the specific language governing permissions and\r\n// limitations under the License.\r\n// </copyright>\r\n//\r\nimport { computed, defineComponent, nextTick, PropType, ref, watch } from \"vue\";\r\nimport RockButton from \"./rockButton\";\r\nimport { trackModalState } from \"@Obsidian/Utility/page\";\r\n\r\nexport default defineComponent({\r\n    name: \"Dialog\",\r\n\r\n    components: {\r\n        RockButton\r\n    },\r\n\r\n    props: {\r\n        modelValue: {\r\n            type: Boolean as PropType<boolean>,\r\n            required: true\r\n        },\r\n\r\n        dismissible: {\r\n            type: Boolean as PropType<boolean>,\r\n            default: true\r\n        }\r\n    },\r\n\r\n    emits: {\r\n        \"update:modelValue\": (_v: boolean) => true\r\n    },\r\n\r\n    setup(props, { emit, slots }) {\r\n        const doShake = ref(false);\r\n        const modalDiv = ref<HTMLElement | null>(null);\r\n\r\n        const hasHeader = computed(() => !!slots.header);\r\n\r\n        const close = (): void => {\r\n            emit(\"update:modelValue\", false);\r\n        };\r\n\r\n        const shake = (): void => {\r\n            if (!doShake.value) {\r\n                doShake.value = true;\r\n                setTimeout(() => doShake.value = false, 1000);\r\n            }\r\n        };\r\n\r\n        const centerOnScreen = (): void => {\r\n            nextTick(() => {\r\n                if (!modalDiv.value) {\r\n                    return;\r\n                }\r\n\r\n                const height = modalDiv.value.offsetHeight;\r\n                const margin = height / 2;\r\n                modalDiv.value.style.marginTop = `-${margin}px`;\r\n            });\r\n        };\r\n\r\n        if (props.modelValue) {\r\n            trackModalState(true);\r\n        }\r\n\r\n        watch(() => props.modelValue, () => {\r\n            trackModalState(props.modelValue);\r\n            if (props.modelValue) {\r\n                centerOnScreen();\r\n            }\r\n        });\r\n\r\n        return {\r\n            centerOnScreen,\r\n            close,\r\n            doShake,\r\n            hasHeader,\r\n            modalDiv,\r\n            shake\r\n        };\r\n    },\r\n\r\n    template: `\r\n<teleport to=\"body\" v-if=\"modelValue\">\r\n        <div class=\"modal-backdrop fade in\" style=\"z-index: 1060;\"></div>\r\n\r\n        <div @click=\"shake\" class=\"modal-scrollable\" style=\"z-index: 1060;\">\r\n            <div @click.stop ref=\"modalDiv\" class=\"modal fade in\" :class=\"{'animated shake': doShake}\" tabindex=\"-1\" role=\"dialog\" style=\"display: block;\">\r\n                <div class=\"modal-dialog\">\r\n                    <div class=\"modal-content\">\r\n                        <div v-if=\"hasHeader\" class=\"modal-header\">\r\n                            <button v-if=\"dismissible\" @click=\"close\" type=\"button\" class=\"close\" style=\"margin-top: -10px;\">×</button>\r\n                            <slot name=\"header\" />\r\n                        </div>\r\n                        <div class=\"modal-body\">\r\n                            <button v-if=\"!hasHeader && dismissible\" @click=\"close\" type=\"button\" class=\"close\" style=\"margin-top: -10px;\">×</button>\r\n                            <slot />\r\n                        </div>\r\n                        <div v-if=\"$slots.footer\" class=\"modal-footer\">\r\n                            <slot name=\"footer\" />\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n</teleport>\r\n`\r\n});\r\n"],"names":["defineComponent","name","components","RockButton","props","modelValue","type","Boolean","required","dismissible","default","emits","_v","setup","_ref","emit","slots","doShake","ref","modalDiv","hasHeader","computed","header","close","shake","value","setTimeout","centerOnScreen","nextTick","height","offsetHeight","margin","style","marginTop","concat","trackModalState","watch","template"],"mappings":";;;;;;;;;;;;;;;;;AAoBA,4CAAeA,eAAe,CAAC;YAC3BC,EAAAA,IAAI,EAAE,QAAQ;YAEdC,EAAAA,UAAU,EAAE;YACRC,IAAAA,UAAAA;eACH;YAEDC,EAAAA,KAAK,EAAE;YACHC,IAAAA,UAAU,EAAE;YACRC,MAAAA,IAAI,EAAEC,OAA4B;YAClCC,MAAAA,QAAQ,EAAE,IAAA;iBACb;YAEDC,IAAAA,WAAW,EAAE;YACTH,MAAAA,IAAI,EAAEC,OAA4B;YAClCG,MAAAA,OAAO,EAAE,IAAA;YACb,KAAA;eACH;YAEDC,EAAAA,KAAK,EAAE;gBACH,mBAAmB,EAAGC,EAAW,IAAK,IAAA;eACzC;YAEDC,EAAAA,KAAKA,CAACT,KAAK,EAAAU,IAAA,EAAmB;YAAA,IAAA,IAAfC,IAAI,GAAAD,IAAA,CAAJC,IAAI;kBAAEC,KAAK,GAAAF,IAAA,CAALE,KAAK,CAAA;YACtB,IAAA,IAAMC,OAAO,GAAGC,GAAG,CAAC,KAAK,CAAC,CAAA;YAC1B,IAAA,IAAMC,QAAQ,GAAGD,GAAG,CAAqB,IAAI,CAAC,CAAA;gBAE9C,IAAME,SAAS,GAAGC,QAAQ,CAAC,MAAM,CAAC,CAACL,KAAK,CAACM,MAAM,CAAC,CAAA;gBAEhD,IAAMC,KAAK,GAAGA,MAAY;YACtBR,MAAAA,IAAI,CAAC,mBAAmB,EAAE,KAAK,CAAC,CAAA;iBACnC,CAAA;gBAED,IAAMS,KAAK,GAAGA,MAAY;YACtB,MAAA,IAAI,CAACP,OAAO,CAACQ,KAAK,EAAE;oBAChBR,OAAO,CAACQ,KAAK,GAAG,IAAI,CAAA;oBACpBC,UAAU,CAAC,MAAMT,OAAO,CAACQ,KAAK,GAAG,KAAK,EAAE,IAAI,CAAC,CAAA;YACjD,OAAA;iBACH,CAAA;gBAED,IAAME,cAAc,GAAGA,MAAY;YAC/BC,MAAAA,QAAQ,CAAC,MAAM;YACX,QAAA,IAAI,CAACT,QAAQ,CAACM,KAAK,EAAE;YACjB,UAAA,OAAA;YACJ,SAAA;YAEA,QAAA,IAAMI,MAAM,GAAGV,QAAQ,CAACM,KAAK,CAACK,YAAY,CAAA;YAC1C,QAAA,IAAMC,MAAM,GAAGF,MAAM,GAAG,CAAC,CAAA;oBACzBV,QAAQ,CAACM,KAAK,CAACO,KAAK,CAACC,SAAS,GAAAC,GAAAA,CAAAA,MAAA,CAAOH,MAAM,EAAI,IAAA,CAAA,CAAA;YACnD,OAAC,CAAC,CAAA;iBACL,CAAA;gBAED,IAAI3B,KAAK,CAACC,UAAU,EAAE;kBAClB8B,eAAe,CAAC,IAAI,CAAC,CAAA;YACzB,KAAA;YAEAC,IAAAA,KAAK,CAAC,MAAMhC,KAAK,CAACC,UAAU,EAAE,MAAM;YAChC8B,MAAAA,eAAe,CAAC/B,KAAK,CAACC,UAAU,CAAC,CAAA;kBACjC,IAAID,KAAK,CAACC,UAAU,EAAE;YAClBsB,QAAAA,cAAc,EAAE,CAAA;YACpB,OAAA;YACJ,KAAC,CAAC,CAAA;gBAEF,OAAO;kBACHA,cAAc;kBACdJ,KAAK;kBACLN,OAAO;kBACPG,SAAS;kBACTD,QAAQ;YACRK,MAAAA,KAAAA;iBACH,CAAA;eACJ;cAEDa,QAAQ,EAAA,0zCAAA;YAyBZ,CAAC,EAAC;;;;;;;;"}