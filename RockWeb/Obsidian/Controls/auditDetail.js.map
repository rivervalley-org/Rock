{"version":3,"file":"auditDetail.js","sources":["../../../Framework/Controls/auditDetail.ts"],"sourcesContent":["// <copyright>\r\n// Copyright by the Spark Development Network\r\n//\r\n// Licensed under the Rock Community License (the \"License\");\r\n// you may not use this file except in compliance with the License.\r\n// You may obtain a copy of the License at\r\n//\r\n// http://www.rockrms.com/license\r\n//\r\n// Unless required by applicable law or agreed to in writing, software\r\n// distributed under the License is distributed on an \"AS IS\" BASIS,\r\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n// See the License for the specific language governing permissions and\r\n// limitations under the License.\r\n// </copyright>\r\n//\r\n\r\nimport { computed, defineComponent, PropType, ref, watch } from \"vue\";\r\nimport { EntityAuditBag } from \"@Obsidian/ViewModels/Utility/entityAuditBag\";\r\nimport { AuditDetailGetAuditDetailsOptionsBag } from \"@Obsidian/ViewModels/Rest/Controls/auditDetailGetAuditDetailsOptionsBag\";\r\nimport { Guid } from \"@Obsidian/Types\";\r\nimport { useHttp } from \"@Obsidian/Utility/http\";\r\nimport { useSecurityGrantToken } from \"@Obsidian/Utility/block\";\r\n\r\nexport default defineComponent({\r\n    name: \"AuditDetail\",\r\n\r\n    props: {\r\n        /**\r\n         * The entity type unique identifier whose audit information will\r\n         * be retrieved and displayed.\r\n         */\r\n        entityTypeGuid: {\r\n            type: String as PropType<Guid>,\r\n            required: false\r\n        },\r\n\r\n        /**\r\n         * The entity identifier key whose audit information will be\r\n         * retrieved and displayed.\r\n         */\r\n        entityKey: {\r\n            type: String as PropType<string>,\r\n            required: false\r\n        }\r\n    },\r\n\r\n    setup(props) {\r\n        // #region Values\r\n\r\n        const securityGrantToken = useSecurityGrantToken();\r\n        const http = useHttp();\r\n        const auditBag = ref<EntityAuditBag | null>(null);\r\n\r\n        // #endregion\r\n\r\n        // #region Computed Values\r\n\r\n        const id = computed(() => auditBag.value?.id?.toString() ?? \"\");\r\n\r\n        const idKey = computed(() => auditBag.value?.idKey ?? \"\");\r\n\r\n        const guid = computed(() => auditBag.value?.guid ?? \"\");\r\n\r\n        const createdByPersonId = computed(() => auditBag.value?.createdByPersonId);\r\n\r\n        const createdByName = computed(() => auditBag.value?.createdByName ?? \"\");\r\n\r\n        const createdRelativeTime = computed(() => auditBag.value?.createdRelativeTime);\r\n\r\n        const modifiedByPersonId = computed(() => auditBag.value?.modifiedByPersonId);\r\n\r\n        const modifiedByName = computed(() => auditBag.value?.modifiedByName ?? \"\");\r\n\r\n        const modifiedRelativeTime = computed(() => auditBag.value?.modifiedRelativeTime);\r\n\r\n        const showId = ref(true);\r\n\r\n        const showGuid = ref(false);\r\n\r\n        // #endregion\r\n\r\n        // #region Functions\r\n\r\n        const getPersonLink = (personId: number): string => {\r\n            return `/Person/${personId}`;\r\n        };\r\n\r\n        const loadAuditBag = async (): Promise<void> => {\r\n            if (!props.entityTypeGuid || !props.entityKey) {\r\n                auditBag.value = null;\r\n                return;\r\n            }\r\n\r\n            const data: AuditDetailGetAuditDetailsOptionsBag = {\r\n                entityTypeGuid: props.entityTypeGuid,\r\n                entityKey: props.entityKey,\r\n                securityGrantToken: securityGrantToken.value\r\n            };\r\n\r\n            const result = await http.post<EntityAuditBag>(\"/api/v2/Controls/AuditDetailGetAuditDetails\", undefined, data);\r\n\r\n            auditBag.value = result.isSuccess && result.data ? result.data : null;\r\n        };\r\n\r\n        // #endregion\r\n\r\n        // #region Event Handlers\r\n\r\n        /**\r\n         * Event handler for when the Id/Guid label is clicked.\r\n         */\r\n        const onIdClick = (): void => {\r\n            if (showId.value) {\r\n                showId.value = false;\r\n                showGuid.value = true;\r\n            }\r\n            else if (showGuid.value) {\r\n                showId.value = false;\r\n                showGuid.value = false;\r\n            }\r\n            else {\r\n                showId.value = true;\r\n                showGuid.value = false;\r\n            }\r\n        };\r\n\r\n        // #endregion\r\n\r\n        watch([() => props.entityTypeGuid, () => props.entityKey], () => {\r\n            loadAuditBag();\r\n        });\r\n\r\n        loadAuditBag();\r\n\r\n        return {\r\n            createdByName,\r\n            createdByPersonId,\r\n            createdRelativeTime,\r\n            getPersonLink,\r\n            guid,\r\n            id,\r\n            idKey,\r\n            modifiedByName,\r\n            modifiedByPersonId,\r\n            modifiedRelativeTime,\r\n            onIdClick,\r\n            showGuid,\r\n            showId\r\n        };\r\n    },\r\n\r\n    template: `\r\n<div class=\"row\">\r\n    <div class=\"col-md-4\">\r\n        <dl>\r\n            <dt>Created By</dt>\r\n            <dd>\r\n                <a v-if=\"createdByPersonId\" :href=\"getPersonLink(createdByPersonId)\">{{ createdByName }}</a>\r\n                <span v-else-if=\"createdByName\">{{ createdByName }}</span>\r\n                <small v-if=\"createdRelativeTime\">&nbsp;({{ createdRelativeTime }})</small>\r\n            </dd>\r\n        </dl>\r\n    </div>\r\n\r\n    <div class=\"col-md-4\">\r\n        <dl>\r\n            <dt>Modified By</dt>\r\n            <dd>\r\n                <a v-if=\"modifiedByPersonId\" :href=\"getPersonLink(modifiedByPersonId)\">{{ modifiedByName }}</a>\r\n                <span v-else-if=\"createdByName\">{{ modifiedByName }}</span>\r\n                <small v-if=\"modifiedRelativeTime\">&nbsp;({{ modifiedRelativeTime }})</small>\r\n            </dd>\r\n        </dl>\r\n    </div>\r\n\r\n    <div class=\"col-md-4\">\r\n        <dl v-if=\"showId\">\r\n            <dt @click.stop=\"onIdClick\" class=\"clickable\">Id</dt>\r\n            <dd>{{ id }}</dd>\r\n        </dl>\r\n        <dl v-else-if=\"showGuid\">\r\n            <dt @click.stop=\"onIdClick\" class=\"clickable\">Guid</dt>\r\n            <dd>{{ guid }}</dd>\r\n        </dl>\r\n        <dl v-else>\r\n            <dt @click.stop=\"onIdClick\" class=\"clickable\">Id Key</dt>\r\n            <dd>{{ idKey }}</dd>\r\n        </dl>\r\n    </div>\r\n</div>\r\n`\r\n});\r\n"],"names":["defineComponent","name","props","entityTypeGuid","type","String","required","entityKey","setup","securityGrantToken","useSecurityGrantToken","http","useHttp","auditBag","ref","id","computed","_auditBag$value$id$to","_auditBag$value","_auditBag$value$id","value","toString","idKey","_auditBag$value$idKey","_auditBag$value2","guid","_auditBag$value$guid","_auditBag$value3","createdByPersonId","_auditBag$value4","createdByName","_auditBag$value$creat","_auditBag$value5","createdRelativeTime","_auditBag$value6","modifiedByPersonId","_auditBag$value7","modifiedByName","_auditBag$value$modif","_auditBag$value8","modifiedRelativeTime","_auditBag$value9","showId","showGuid","getPersonLink","personId","concat","loadAuditBag","_ref","_asyncToGenerator","data","result","post","undefined","isSuccess","apply","arguments","onIdClick","watch","template"],"mappings":"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"}