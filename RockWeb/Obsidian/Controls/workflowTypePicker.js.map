{"version":3,"file":"workflowTypePicker.js","sources":["../../../Framework/Controls/workflowTypePicker.ts"],"sourcesContent":["// <copyright>\r\n// Copyright by the Spark Development Network\r\n//\r\n// Licensed under the Rock Community License (the \"License\");\r\n// you may not use this file except in compliance with the License.\r\n// You may obtain a copy of the License at\r\n//\r\n// http://www.rockrms.com/license\r\n//\r\n// Unless required by applicable law or agreed to in writing, software\r\n// distributed under the License is distributed on an \"AS IS\" BASIS,\r\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n// See the License for the specific language governing permissions and\r\n// limitations under the License.\r\n// </copyright>\r\n//\r\n\r\nimport { useSecurityGrantToken } from \"@Obsidian/Utility/block\";\r\nimport { standardAsyncPickerProps, updateRefValue, useStandardAsyncPickerProps } from \"@Obsidian/Utility/component\";\r\nimport { ListItemBag } from \"@Obsidian/ViewModels/Utility/listItemBag\";\r\nimport { defineComponent, PropType, ref, watch } from \"vue\";\r\nimport { WorkflowTypeTreeItemProvider } from \"@Obsidian/Utility/treeItemProviders\";\r\nimport RockFormField from \"./rockFormField\";\r\nimport TreeItemPicker from \"./treeItemPicker.obs\";\r\n\r\nexport default defineComponent({\r\n    name: \"WorkflowTypePicker\",\r\n\r\n    components: {\r\n        TreeItemPicker,\r\n        RockFormField\r\n    },\r\n\r\n    props: {\r\n        modelValue: {\r\n            type: Object as PropType<ListItemBag | ListItemBag[] | null>,\r\n            required: false\r\n        },\r\n\r\n        includeInactiveItems: {\r\n            type: Boolean as PropType<boolean>,\r\n            default: false\r\n        },\r\n\r\n        ...standardAsyncPickerProps\r\n    },\r\n\r\n    emits: {\r\n        \"update:modelValue\": (_value: ListItemBag | ListItemBag[] | null) => true\r\n    },\r\n\r\n    setup(props, { emit }) {\r\n        // #region Values\r\n\r\n        const internalValue = ref(props.modelValue ?? null);\r\n        const securityGrantToken = useSecurityGrantToken();\r\n        const standardProps = useStandardAsyncPickerProps(props);\r\n\r\n        const itemProvider = ref(new WorkflowTypeTreeItemProvider());\r\n        itemProvider.value.includeInactiveItems = props.includeInactiveItems;\r\n        itemProvider.value.securityGrantToken = securityGrantToken.value;\r\n\r\n        // #endregion\r\n\r\n        // #region Watchers\r\n\r\n        // Keep security token up to date, but don't need refetch data\r\n        watch(securityGrantToken, () => {\r\n            itemProvider.value.securityGrantToken = securityGrantToken.value;\r\n        });\r\n\r\n        // When this changes, we need to refetch the data, so reset the whole itemProvider\r\n        watch(() => props.includeInactiveItems, () => {\r\n            const oldProvider = itemProvider.value;\r\n            const newProvider = new WorkflowTypeTreeItemProvider();\r\n\r\n            // copy old provider's properties\r\n            newProvider.securityGrantToken = oldProvider.securityGrantToken;\r\n            // Use new value\r\n            newProvider.includeInactiveItems = props.includeInactiveItems;\r\n\r\n            // Set the provider to the new one\r\n            itemProvider.value = newProvider;\r\n        });\r\n\r\n        watch(internalValue, () => {\r\n            emit(\"update:modelValue\", internalValue.value);\r\n        });\r\n\r\n        watch(() => props.modelValue, () => {\r\n            updateRefValue(internalValue, props.modelValue ?? null);\r\n        });\r\n\r\n        // #endregion\r\n\r\n        return {\r\n            internalValue,\r\n            itemProvider,\r\n            standardProps\r\n        };\r\n    },\r\n    template: `\r\n<TreeItemPicker v-model=\"internalValue\"\r\n    v-bind=\"standardProps\"\r\n    formGroupClasses=\"category-picker\"\r\n    iconCssClass=\"fa fa-cogs\"\r\n    :provider=\"itemProvider\"\r\n    :multiple=\"multiple\"\r\n    disableFolderSelection\r\n/>\r\n`\r\n});\r\n"],"names":["defineComponent","name","components","TreeItemPicker","RockFormField","props","_objectSpread","modelValue","type","Object","required","includeInactiveItems","Boolean","default","standardAsyncPickerProps","emits","_value","setup","_ref","_props$modelValue","emit","internalValue","ref","securityGrantToken","useSecurityGrantToken","standardProps","useStandardAsyncPickerProps","itemProvider","WorkflowTypeTreeItemProvider","value","watch","oldProvider","newProvider","_props$modelValue2","updateRefValue","template"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyBA,kDAAeA,eAAe,CAAC;MAC3BC,EAAAA,IAAI,EAAE,oBAAoB;MAE1BC,EAAAA,UAAU,EAAE;UACRC,cAAc;MACdC,IAAAA,aAAAA;SACH;MAEDC,EAAAA,KAAK,EAAAC,cAAA,CAAA;MACDC,IAAAA,UAAU,EAAE;MACRC,MAAAA,IAAI,EAAEC,MAAsD;MAC5DC,MAAAA,QAAQ,EAAE,KAAA;WACb;MAEDC,IAAAA,oBAAoB,EAAE;MAClBH,MAAAA,IAAI,EAAEI,OAA4B;MAClCC,MAAAA,OAAO,EAAE,KAAA;MACb,KAAA;MAAC,GAAA,EAEEC,wBAAwB,CAC9B;MAEDC,EAAAA,KAAK,EAAE;UACH,mBAAmB,EAAGC,MAA0C,IAAK,IAAA;SACxE;MAEDC,EAAAA,KAAKA,CAACZ,KAAK,EAAAa,IAAA,EAAY;MAAA,IAAA,IAAAC,iBAAA,CAAA;MAAA,IAAA,IAARC,IAAI,GAAAF,IAAA,CAAJE,IAAI,CAAA;MAGf,IAAA,IAAMC,aAAa,GAAGC,GAAG,CAAA,CAAAH,iBAAA,GAACd,KAAK,CAACE,UAAU,cAAAY,iBAAA,KAAA,KAAA,CAAA,GAAAA,iBAAA,GAAI,IAAI,CAAC,CAAA;UACnD,IAAMI,kBAAkB,GAAGC,qBAAqB,EAAE,CAAA;MAClD,IAAA,IAAMC,aAAa,GAAGC,2BAA2B,CAACrB,KAAK,CAAC,CAAA;MAExD,IAAA,IAAMsB,YAAY,GAAGL,GAAG,CAAC,IAAIM,4BAA4B,EAAE,CAAC,CAAA;MAC5DD,IAAAA,YAAY,CAACE,KAAK,CAAClB,oBAAoB,GAAGN,KAAK,CAACM,oBAAoB,CAAA;MACpEgB,IAAAA,YAAY,CAACE,KAAK,CAACN,kBAAkB,GAAGA,kBAAkB,CAACM,KAAK,CAAA;UAOhEC,KAAK,CAACP,kBAAkB,EAAE,MAAM;MAC5BI,MAAAA,YAAY,CAACE,KAAK,CAACN,kBAAkB,GAAGA,kBAAkB,CAACM,KAAK,CAAA;MACpE,KAAC,CAAC,CAAA;MAGFC,IAAAA,KAAK,CAAC,MAAMzB,KAAK,CAACM,oBAAoB,EAAE,MAAM;MAC1C,MAAA,IAAMoB,WAAW,GAAGJ,YAAY,CAACE,KAAK,CAAA;MACtC,MAAA,IAAMG,WAAW,GAAG,IAAIJ,4BAA4B,EAAE,CAAA;MAGtDI,MAAAA,WAAW,CAACT,kBAAkB,GAAGQ,WAAW,CAACR,kBAAkB,CAAA;MAE/DS,MAAAA,WAAW,CAACrB,oBAAoB,GAAGN,KAAK,CAACM,oBAAoB,CAAA;YAG7DgB,YAAY,CAACE,KAAK,GAAGG,WAAW,CAAA;MACpC,KAAC,CAAC,CAAA;UAEFF,KAAK,CAACT,aAAa,EAAE,MAAM;MACvBD,MAAAA,IAAI,CAAC,mBAAmB,EAAEC,aAAa,CAACQ,KAAK,CAAC,CAAA;MAClD,KAAC,CAAC,CAAA;MAEFC,IAAAA,KAAK,CAAC,MAAMzB,KAAK,CAACE,UAAU,EAAE,MAAM;MAAA,MAAA,IAAA0B,kBAAA,CAAA;MAChCC,MAAAA,cAAc,CAACb,aAAa,EAAAY,CAAAA,kBAAA,GAAE5B,KAAK,CAACE,UAAU,MAAA,IAAA,IAAA0B,kBAAA,KAAA,KAAA,CAAA,GAAAA,kBAAA,GAAI,IAAI,CAAC,CAAA;MAC3D,KAAC,CAAC,CAAA;UAIF,OAAO;YACHZ,aAAa;YACbM,YAAY;MACZF,MAAAA,aAAAA;WACH,CAAA;SACJ;QACDU,QAAQ,EAAA,oPAAA;MAUZ,CAAC,EAAC;;;;;;;;"}