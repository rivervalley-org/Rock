{"version":3,"file":"categorizedValuePicker.obs.js","sources":["../../../Framework/Controls/categorizedValuePicker.obs"],"sourcesContent":["<!-- Copyright by the Spark Development Network; Licensed under the Rock Community License -->\r\n<template>\r\n    <RockFormField v-if=\"error\" v-bind=\"formFieldProps\" :modelValue=\"internalValue\" name=\"cat-val-picker\">\r\n        <NotificationBox :alertType=\"AlertType.Danger\">\r\n            An error occurred while fetching category tree.&nbsp;<RockButton @click=\"loadTree\">Retry</RockButton>\r\n        </NotificationBox>\r\n    </RockFormField>\r\n    <RockFormField v-else-if=\"loadedItems\" v-bind=\"formFieldProps\" :modelValue=\"internalValue\" name=\"cat-val-picker\">\r\n        <CategorizedValuePickerDropDownLevel v-bind=\"formFieldProps\" :root=\"loadedItems\" v-model=\"internalValue\" :definedTypeName=\"definedTypeName\" key=\"root-cat-val-picker\" />\r\n    </RockFormField>\r\n    <DropDownList v-else v-bind=\"formFieldProps\" loading :modelValue=\"internalValue?.value ?? ''\" />\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\n    import { Guid } from \"@Obsidian/Types\";\r\n    import { PropType, ref, watch } from \"vue\";\r\n    import CategorizedValuePickerDropDownLevel from \"./categorizedValuePickerDropDownLevel.obs\";\r\n    import RockFormField from \"./rockFormField\";\r\n    import { CategorizedValuePickerGetTreeOptionsBag } from \"@Obsidian/ViewModels/Rest/Controls/categorizedValuePickerGetTreeOptionsBag\";\r\n    import { CategorizedValuePickerGetTreeResultsBag } from \"@Obsidian/ViewModels/Rest/Controls/categorizedValuePickerGetTreeResultsBag\";\r\n    import { CategorizedValuePickerNodeBag } from \"@Obsidian/ViewModels/Rest/Controls/categorizedValuePickerNodeBag\";\r\n    import { ListItemBag } from \"@Obsidian/ViewModels/Utility/listItemBag\";\r\n    import { useHttp } from \"@Obsidian/Utility/http\";\r\n    import { useVModelPassthrough, standardRockFormFieldProps, useStandardRockFormFieldProps } from \"@Obsidian/Utility/component\";\r\n    import NotificationBox from \"./notificationBox.obs\";\r\n    import { AlertType } from \"@Obsidian/Enums/Controls/alertType\";\r\n    import RockButton from \"./rockButton\";\r\n    import DropDownList from \"./dropDownList\";\r\n\r\n    const props = defineProps({\r\n        modelValue: {\r\n            type: String as PropType<ListItemBag | null>,\r\n            default: \"\"\r\n        },\r\n\r\n        definedTypeGuid: {\r\n            type: String as PropType<Guid>,\r\n            required: true\r\n        },\r\n\r\n        onlyIncludeGuids: {\r\n            type: Array as PropType<Guid[] | null>,\r\n            default: null\r\n        },\r\n\r\n        ...standardRockFormFieldProps\r\n    });\r\n\r\n    const emit = defineEmits<{\r\n        (e: \"update:modelValue\", value: ListItemBag | null): void\r\n    }>();\r\n\r\n    const http = useHttp();\r\n    const loadedItems = ref<CategorizedValuePickerNodeBag | null>(null);\r\n    const error = ref<boolean>(false);\r\n    const definedTypeName = ref<string>(\"\");\r\n    const internalValue = useVModelPassthrough(props, \"modelValue\", emit);\r\n\r\n    const formFieldProps = useStandardRockFormFieldProps(props);\r\n\r\n    async function loadTree(): Promise<void> {\r\n        error.value = false;\r\n        const options: Partial<CategorizedValuePickerGetTreeOptionsBag> = {\r\n            definedTypeGuid: props.definedTypeGuid,\r\n            onlyIncludeGuids: props.onlyIncludeGuids\r\n        };\r\n        const result = await http.post<CategorizedValuePickerGetTreeResultsBag>(\"/api/v2/Controls/CategorizedValuePickerGetTree\", undefined, options);\r\n\r\n        if (result.isSuccess && result.data) {\r\n            loadedItems.value = result.data.tree ?? null;\r\n            definedTypeName.value = result.data.definedType ?? \"\";\r\n            return;\r\n        }\r\n\r\n        console.error(result.errorMessage ?? \"Unknown error while loading data.\");\r\n        error.value = true;\r\n        loadedItems.value = null;\r\n        definedTypeName.value = \"\";\r\n    }\r\n\r\n    watch(() => props.definedTypeGuid, loadTree, { immediate: true });\r\n</script>"],"names":["http","useHttp","loadedItems","ref","error","definedTypeName","internalValue","useVModelPassthrough","props","emit","formFieldProps","useStandardRockFormFieldProps","loadTree","_loadTree","apply","arguments","_asyncToGenerator","_result$errorMessage","value","options","definedTypeGuid","onlyIncludeGuids","result","post","undefined","isSuccess","data","_result$data$tree","_result$data$definedT","tree","definedType","console","errorMessage","watch","immediate"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;UAoDI,IAAMA,IAAI,GAAGC,OAAO,EAAE,CAAA;MACtB,IAAA,IAAMC,WAAW,GAAGC,GAAG,CAAuC,IAAI,CAAC,CAAA;MACnE,IAAA,IAAMC,KAAK,GAAGD,GAAG,CAAU,KAAK,CAAC,CAAA;MACjC,IAAA,IAAME,eAAe,GAAGF,GAAG,CAAS,EAAE,CAAC,CAAA;UACvC,IAAMG,aAAa,GAAGC,oBAAoB,CAACC,KAAK,EAAE,YAAY,EAAEC,IAAI,CAAC,CAAA;MAErE,IAAA,IAAMC,cAAc,GAAGC,6BAA6B,CAACH,KAAK,CAAC,CAAA;MAAC,IAAA,SAE7CI,QAAQA,GAAA;MAAA,MAAA,OAAAC,SAAA,CAAAC,KAAA,CAAA,IAAA,EAAAC,SAAA,CAAA,CAAA;MAAA,KAAA;MAAA,IAAA,SAAAF,SAAA,GAAA;YAAAA,SAAA,GAAAG,iBAAA,CAAvB,aAAyC;MAAA,QAAA,IAAAC,oBAAA,CAAA;cACrCb,KAAK,CAACc,KAAK,GAAG,KAAK,CAAA;MACnB,QAAA,IAAMC,OAAyD,GAAG;gBAC9DC,eAAe,EAAEZ,KAAK,CAACY,eAAe;gBACtCC,gBAAgB,EAAEb,KAAK,CAACa,gBAAAA;eAC3B,CAAA;cACD,IAAMC,MAAM,GAAStB,MAAAA,IAAI,CAACuB,IAAI,CAA0C,gDAAgD,EAAEC,SAAS,EAAEL,OAAO,CAAC,CAAA;MAE7I,QAAA,IAAIG,MAAM,CAACG,SAAS,IAAIH,MAAM,CAACI,IAAI,EAAE;gBAAA,IAAAC,iBAAA,EAAAC,qBAAA,CAAA;MACjC1B,UAAAA,WAAW,CAACgB,KAAK,GAAAS,CAAAA,iBAAA,GAAGL,MAAM,CAACI,IAAI,CAACG,IAAI,MAAAF,IAAAA,IAAAA,iBAAA,KAAAA,KAAAA,CAAAA,GAAAA,iBAAA,GAAI,IAAI,CAAA;MAC5CtB,UAAAA,eAAe,CAACa,KAAK,GAAAU,CAAAA,qBAAA,GAAGN,MAAM,CAACI,IAAI,CAACI,WAAW,MAAAF,IAAAA,IAAAA,qBAAA,KAAAA,KAAAA,CAAAA,GAAAA,qBAAA,GAAI,EAAE,CAAA;MACrD,UAAA,OAAA;MACJ,SAAA;MAEAG,QAAAA,OAAO,CAAC3B,KAAK,CAAAa,CAAAA,oBAAA,GAACK,MAAM,CAACU,YAAY,MAAA,IAAA,IAAAf,oBAAA,KAAA,KAAA,CAAA,GAAAA,oBAAA,GAAI,mCAAmC,CAAC,CAAA;cACzEb,KAAK,CAACc,KAAK,GAAG,IAAI,CAAA;cAClBhB,WAAW,CAACgB,KAAK,GAAG,IAAI,CAAA;cACxBb,eAAe,CAACa,KAAK,GAAG,EAAE,CAAA;aAC7B,CAAA,CAAA;MAAA,MAAA,OAAAL,SAAA,CAAAC,KAAA,CAAA,IAAA,EAAAC,SAAA,CAAA,CAAA;MAAA,KAAA;MAEDkB,IAAAA,KAAK,CAAC,MAAMzB,KAAK,CAACY,eAAe,EAAER,QAAQ,EAAE;MAAEsB,MAAAA,SAAS,EAAE,IAAA;MAAK,KAAC,CAAC,CAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}