{"version":3,"file":"keyValueList.js","sources":["../../../Framework/Controls/keyValueList.ts"],"sourcesContent":["// <copyright>\r\n// Copyright by the Spark Development Network\r\n//\r\n// Licensed under the Rock Community License (the \"License\");\r\n// you may not use this file except in compliance with the License.\r\n// You may obtain a copy of the License at\r\n//\r\n// http://www.rockrms.com/license\r\n//\r\n// Unless required by applicable law or agreed to in writing, software\r\n// distributed under the License is distributed on an \"AS IS\" BASIS,\r\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n// See the License for the specific language governing permissions and\r\n// limitations under the License.\r\n// </copyright>\r\n//\r\nimport { computed, defineComponent, PropType, ref, watch } from \"vue\";\r\nimport DropDownList from \"./dropDownList\";\r\nimport RockFormField from \"./rockFormField\";\r\nimport TextBox from \"./textBox\";\r\nimport { ListItemBag } from \"@Obsidian/ViewModels/Utility/listItemBag\";\r\n\r\nexport type KeyValueItem = {\r\n    key?: string | null;\r\n\r\n    value?: string | null;\r\n};\r\n\r\nexport default defineComponent({\r\n    name: \"KeyValueListField.Edit\",\r\n\r\n    components: {\r\n        RockFormField,\r\n        DropDownList,\r\n        TextBox\r\n    },\r\n\r\n    props: {\r\n        modelValue: {\r\n            type: Array as PropType<KeyValueItem[]>,\r\n            required: false\r\n        },\r\n\r\n        valueOptions: {\r\n            type: Array as PropType<ListItemBag[]>,\r\n            required: false\r\n        },\r\n\r\n        keyPlaceholder: {\r\n            type: String as PropType<string>,\r\n            required: false\r\n        },\r\n\r\n        valuePlaceholder: {\r\n            type: String as PropType<string>,\r\n            required: false\r\n        },\r\n\r\n        displayValueFirst: {\r\n            type: Boolean as PropType<boolean>,\r\n            default: false\r\n        }\r\n    },\r\n\r\n    emits: {\r\n        \"update:modelValue\": (_value: KeyValueItem[]) => true\r\n    },\r\n\r\n    setup(props, { emit }) {\r\n        const internalValues = ref(props.modelValue ?? []);\r\n\r\n        /** The options to choose from in the drop down list */\r\n        const options = computed((): ListItemBag[] => props.valueOptions ?? []);\r\n\r\n        const hasValues = computed((): boolean => options.value.length > 0);\r\n\r\n        watch(() => props.modelValue, () => {\r\n            internalValues.value = props.modelValue ?? [];\r\n        });\r\n\r\n        watch(() => internalValues.value, () => {\r\n            emit(\"update:modelValue\", internalValues.value);\r\n        }, {\r\n            deep: true\r\n        });\r\n\r\n        const onAddClick = (): void => {\r\n            let defaultValue = \"\";\r\n\r\n            if (hasValues.value) {\r\n                defaultValue = options.value[0].value ?? \"\";\r\n            }\r\n\r\n            internalValues.value.push({ key: \"\", value: defaultValue });\r\n        };\r\n\r\n        const onRemoveClick = (index: number): void => {\r\n            internalValues.value.splice(index, 1);\r\n        };\r\n\r\n        return {\r\n            internalValues,\r\n            hasValues,\r\n            options,\r\n            onAddClick,\r\n            onRemoveClick\r\n        };\r\n    },\r\n\r\n    template: `\r\n<RockFormField\r\n    :modelValue=\"internalValues\"\r\n    formGroupClasses=\"key-value-list\"\r\n    name=\"key-value-list\">\r\n    <template #default=\"{uniqueId}\">\r\n        <div class=\"control-wrapper\">\r\n<span :id=\"uniqueId\" class=\"key-value-list\">\r\n    <span class=\"key-value-rows\">\r\n        <div v-for=\"(value, valueIndex) in internalValues\" class=\"controls controls-row form-control-group\">\r\n            <template v-if=\"!displayValueFirst\">\r\n                <input v-model=\"value.key\" class=\"key-value-key form-control input-width-md\" type=\"text\" :placeholder=\"keyPlaceholder\">\r\n\r\n                <select v-if=\"hasValues\" v-model=\"value.value\" class=\"form-control input-width-lg\">\r\n                    <option v-for=\"option in options\" :value=\"option.value\" :key=\"option.value\">{{ option.text }}</option>\r\n                </select>\r\n                <input v-else v-model=\"value.value\" class=\"key-value-value form-control input-width-md\" type=\"text\" :placeholder=\"valuePlaceholder\">\r\n            </template>\r\n            <template v-else>\r\n                <select v-if=\"hasValues\" v-model=\"value.value\" class=\"form-control input-width-lg\">\r\n                    <option v-for=\"option in options\" :value=\"option.value\" :key=\"option.value\">{{ option.text }}</option>\r\n                </select>\r\n                <input v-else v-model=\"value.value\" class=\"key-value-value form-control input-width-md\" type=\"text\" :placeholder=\"valuePlaceholder\">\r\n\r\n                <input v-model=\"value.key\" class=\"key-value-key form-control input-width-md\" type=\"text\" :placeholder=\"keyPlaceholder\">\r\n            </template>\r\n\r\n            <a href=\"#\" @click.prevent=\"onRemoveClick(valueIndex)\" class=\"btn btn-sm btn-danger\"><i class=\"fa fa-times\"></i></a>\r\n        </div>\r\n    </span>\r\n    <div class=\"control-actions\">\r\n        <a class=\"btn btn-action btn-square btn-xs\" href=\"#\" @click.prevent=\"onAddClick\"><i class=\"fa fa-plus-circle\"></i></a>\r\n    </div>\r\n</span>\r\n        </div>\r\n    </template>\r\n</RockFormField>\r\n`\r\n});\r\n"],"names":["defineComponent","name","components","RockFormField","DropDownList","TextBox","props","modelValue","type","Array","required","valueOptions","keyPlaceholder","String","valuePlaceholder","displayValueFirst","Boolean","default","emits","_value","setup","_ref","_props$modelValue","emit","internalValues","ref","options","computed","_props$valueOptions","hasValues","value","length","watch","_props$modelValue2","deep","onAddClick","defaultValue","_options$value$0$valu","push","key","onRemoveClick","index","splice","template"],"mappings":"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"}