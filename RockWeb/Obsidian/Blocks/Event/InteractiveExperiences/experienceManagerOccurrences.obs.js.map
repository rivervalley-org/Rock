{"version":3,"file":"experienceManagerOccurrences.obs.js","sources":["../../../src/Event/InteractiveExperiences/ExperienceManagerOccurrences/types.partial.ts","../../../src/Event/InteractiveExperiences/experienceManagerOccurrences.obs"],"sourcesContent":["// <copyright>\r\n// Copyright by the Spark Development Network\r\n//\r\n// Licensed under the Rock Community License (the \"License\");\r\n// you may not use this file except in compliance with the License.\r\n// You may obtain a copy of the License at\r\n//\r\n// http://www.rockrms.com/license\r\n//\r\n// Unless required by applicable law or agreed to in writing, software\r\n// distributed under the License is distributed on an \"AS IS\" BASIS,\r\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n// See the License for the specific language governing permissions and\r\n// limitations under the License.\r\n// </copyright>\r\n//\r\n\r\nexport const enum NavigationUrlKey {\r\n    ExperienceManagerPage = \"ExperienceManagerPage\"\r\n}\r\n","<!-- Copyright by the Spark Development Network; Licensed under the Rock Community License -->\r\n<template>\r\n    <NotificationBox v-if=\"blockErrorMessage\"\r\n                     alertType=\"warning\">\r\n        {{ blockErrorMessage }}\r\n    </NotificationBox>\r\n\r\n    <Panel v-else-if=\"isPanelVisible\" type=\"block\" :title=\"experienceName\">\r\n        <SectionHeader description=\"There are multiple experience occurrences happening right now. Please select the one you would like to manage.\" />\r\n\r\n        <a v-for=\"occurrence in occurrences\" class=\"d-flex rounded overflow-hidden mb-2 align-items-stretch border border-gray-400\" :href=\"getOccurrenceLink(occurrence)\">\r\n            <div class=\"p-2 d-flex align-items-center align-self-stretch bg-info text-white\">\r\n                <span>\r\n                    <i class=\"fa fa-calendar-alt\"></i>\r\n                </span>\r\n            </div>\r\n\r\n            <div class=\"p-2 d-flex align-items-center align-self-stretch flex-grow-1 text-body\">\r\n                {{ occurrence.text }}\r\n            </div>\r\n\r\n            <div class=\"p-2 mr-2 d-flex align-items-center align-self-stretch text-info\">\r\n                <span>\r\n                    <i class=\"fa fa-arrow-circle-right\"></i>\r\n                </span>\r\n            </div>\r\n        </a>\r\n    </Panel>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\n    import NotificationBox from \"@Obsidian/Controls/notificationBox.obs\";\r\n    import Panel from \"@Obsidian/Controls/panel\";\r\n    import SectionHeader from \"@Obsidian/Controls/sectionHeader\";\r\n    import { useConfigurationValues, useReloadBlock, onConfigurationValuesChanged } from \"@Obsidian/Utility/block\";\r\n    import { ExperienceManagerOccurrencesInitializationBox } from \"@Obsidian/ViewModels/Blocks/Event/InteractiveExperiences/ExperienceManagerOccurrences/experienceManagerOccurrencesInitializationBox\";\r\n    import { computed, ref } from \"vue\";\r\n    import { ListItemBag } from \"@Obsidian/ViewModels/Utility/listItemBag\";\r\n    import { NavigationUrlKey } from \"./ExperienceManagerOccurrences/types.partial\";\r\n\r\n    const config = useConfigurationValues<ExperienceManagerOccurrencesInitializationBox>();\r\n\r\n    // #region Values\r\n\r\n    const isPanelVisible = ref(true);\r\n\r\n    // #endregion\r\n\r\n    // #region Computed Values\r\n\r\n    const blockErrorMessage = computed((): string | undefined | null => {\r\n        return config.errorMessage;\r\n    });\r\n\r\n    const occurrences = computed((): ListItemBag[] => {\r\n        return config.occurrences ?? [];\r\n    });\r\n\r\n    const experienceName = computed((): string => {\r\n        return config.experienceName ?? \"Experience\";\r\n    });\r\n\r\n    // #endregion\r\n\r\n    // #region Functions\r\n\r\n    function getOccurrenceLink(occurrence: ListItemBag): string {\r\n        const urlTemplate = config.navigationUrls?.[NavigationUrlKey.ExperienceManagerPage];\r\n\r\n        if (!urlTemplate || !occurrence.value) {\r\n            return \"#\";\r\n        }\r\n\r\n        return urlTemplate.replace(\"((Id))\", occurrence.value);\r\n    }\r\n\r\n    // #endregion\r\n\r\n    // #region Event Handlers\r\n\r\n    // #endregion\r\n\r\n    // If only one occurrence, redirect to the manager page. This should be\r\n    // replaced with a server-side redirect once that is possible.\r\n    if (occurrences.value.length === 1) {\r\n        isPanelVisible.value = false;\r\n\r\n        window.location.href = getOccurrenceLink(occurrences.value[0]);\r\n    }\r\n\r\n    onConfigurationValuesChanged(useReloadBlock());\r\n</script>\r\n"],"names":["NavigationUrlKey","config","useConfigurationValues","isPanelVisible","ref","blockErrorMessage","computed","errorMessage","occurrences","_config$occurrences","experienceName","_config$experienceNam","getOccurrenceLink","occurrence","_config$navigationUrl","urlTemplate","navigationUrls","ExperienceManagerPage","value","replace","length","window","location","href","onConfigurationValuesChanged","useReloadBlock"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;YAiBkBA,IAAAA,gBAAgB,aAAhBA,gBAAgB,EAAA;cAAhBA,gBAAgB,CAAA,uBAAA,CAAA,GAAA,uBAAA,CAAA;YAAA,EAAA,OAAhBA,gBAAgB,CAAA;YAAA,CAAA,CAAA,EAAA,CAAA;;;;;;;;;;;;;;;;;;;gBCuB9B,IAAMC,MAAM,GAAGC,sBAAsB,EAAiD,CAAA;YAItF,IAAA,IAAMC,cAAc,GAAGC,GAAG,CAAC,IAAI,CAAC,CAAA;YAMhC,IAAA,IAAMC,iBAAiB,GAAGC,QAAQ,CAAC,MAAiC;kBAChE,OAAOL,MAAM,CAACM,YAAY,CAAA;YAC9B,KAAC,CAAC,CAAA;YAEF,IAAA,IAAMC,WAAW,GAAGF,QAAQ,CAAC,MAAqB;YAAA,MAAA,IAAAG,mBAAA,CAAA;kBAC9C,OAAAA,CAAAA,mBAAA,GAAOR,MAAM,CAACO,WAAW,cAAAC,mBAAA,KAAA,KAAA,CAAA,GAAAA,mBAAA,GAAI,EAAE,CAAA;YACnC,KAAC,CAAC,CAAA;YAEF,IAAA,IAAMC,cAAc,GAAGJ,QAAQ,CAAC,MAAc;YAAA,MAAA,IAAAK,qBAAA,CAAA;kBAC1C,OAAAA,CAAAA,qBAAA,GAAOV,MAAM,CAACS,cAAc,cAAAC,qBAAA,KAAA,KAAA,CAAA,GAAAA,qBAAA,GAAI,YAAY,CAAA;YAChD,KAAC,CAAC,CAAA;gBAMF,SAASC,iBAAiBA,CAACC,UAAuB,EAAU;YAAA,MAAA,IAAAC,qBAAA,CAAA;YACxD,MAAA,IAAMC,WAAW,GAAA,CAAAD,qBAAA,GAAGb,MAAM,CAACe,cAAc,MAAAF,IAAAA,IAAAA,qBAAA,uBAArBA,qBAAA,CAAwBd,gBAAgB,CAACiB,qBAAqB,CAAC,CAAA;YAEnF,MAAA,IAAI,CAACF,WAAW,IAAI,CAACF,UAAU,CAACK,KAAK,EAAE;YACnC,QAAA,OAAO,GAAG,CAAA;YACd,OAAA;kBAEA,OAAOH,WAAW,CAACI,OAAO,CAAC,QAAQ,EAAEN,UAAU,CAACK,KAAK,CAAC,CAAA;YAC1D,KAAA;YAUA,IAAA,IAAIV,WAAW,CAACU,KAAK,CAACE,MAAM,KAAK,CAAC,EAAE;kBAChCjB,cAAc,CAACe,KAAK,GAAG,KAAK,CAAA;YAE5BG,MAAAA,MAAM,CAACC,QAAQ,CAACC,IAAI,GAAGX,iBAAiB,CAACJ,WAAW,CAACU,KAAK,CAAC,CAAC,CAAC,CAAC,CAAA;YAClE,KAAA;gBAEAM,4BAA4B,CAACC,cAAc,EAAE,CAAC,CAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;"}